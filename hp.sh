#!/bin/bash

# Define the new data to be written in hex format
DATA=(
    "03" "04" "07" "10" "00" "00" "00" "00" "00" "00" "00" "06" "67" "00" "00" "00"
    "08" "03" "00" "1e" "53" "4f" "55" "52" "43" "45" "50" "48" "4f" "54" "4f" "4e"
    "49" "43" "53" "20" "00" "00" "1f" "22" "41" "58" "53" "38" "35" "2d" "31" "39"
    "32" "2d" "4d" "33" "2d" "48" "50" "20" "31" "30" "20" "20" "03" "52" "00" "47"
    "00" "1a" "00" "00" "48" "50" "59" "31" "30" "31" "4f" "36" "31" "32" "31" "38"
    "20" "20" "20" "20" "32" "34" "30" "35" "32" "38" "20" "20" "68" "f0" "03" "3e"
    "48" "50" "a0" "00" "80" "50" "20" "20" "4a" "39" "31" "35" "30" "44" "20" "31"
    "39" "39" "30" "2d" "34" "33" "39" "31" "1f" "20" "20" "32" "00" "00" "00" "00"
    "10" "31" "f1" "e3" "d6" "b5" "28" "11" "23" "15" "b1" "f6" "cf" "33" "34" "cc"
    "1f" "01" "00" "00" "00" "00" "00" "00" "00" "00" "00" "00" "00" "00" "00" "00"
    "00" "00" "48" "50" "20" "50" "72" "6f" "43" "75" "72" "76" "65" "20" "50" "72"
    "6f" "70" "72" "69" "65" "74" "61" "72" "79" "20" "74" "72" "61" "64" "65" "20"
    "73" "65" "63" "72" "65" "74" "20" "2d" "20" "63" "6f" "70" "79" "69" "6e" "67"
    "20" "69" "73" "20" "70" "72" "6f" "68" "69" "62" "69" "74" "65" "64" "20" "77"
    "69" "74" "68" "6f" "75" "74" "20" "70" "65" "72" "6d" "69" "73" "73" "69" "6f"
    "6e" "2e" "00" "00" "00" "00" "00" "00" "00" "00" "00" "00" "00" "00" "00" "00"
)

# Total number of addresses to write (0x00 to 0xFF = 256)
TOTAL_ADDRESSES=256

# Unlocking module
echo "Unlocking module"
./myunlock.sh
sleep 1

# Write data to the specified addresses
start_addr=0
echo "Writing data"
for value in "${DATA[@]}"; do
    i2cset -y 1 0x50 0x$(printf "%02x" ${start_addr}) 0x$value
    sleep 0.05
    start_addr=$((start_addr + 1))
done

# Write 00 to remaining addresses
for (( ; start_addr < TOTAL_ADDRESSES; start_addr++ )); do
    i2cset -y 1 0x50 0x$(printf "%02x" ${start_addr}) 0x00
    sleep 0.05
done
